{"version":3,"sources":["../../src/controller/account.js"],"names":["config","db","api","post","req","res","console","log","body","email","register","username","password","err","account","send","authenticate","session","json","message","scope","get","logout","status","user"],"mappings":";;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;kBAIgB,gBAAkB;AAAA,MAAhBA,MAAgB,QAAhBA,MAAgB;AAAA,MAARC,EAAQ,QAARA,EAAQ;;AAC5B,MAAIC,MAAM,sBAAV;;AAEJA,MAAIC,IAAJ,CAAS,WAAT,EAAsB,UAACC,GAAD,EAAKC,GAAL,EAAW;AAC5BC,YAAQC,GAAR,CAAYH,IAAII,IAAJ,CAASC,KAArB;AACH,sBAAQC,QAAR,CAAiB,sBAAY,EAAEC,UAAUP,IAAII,IAAJ,CAASC,KAArB,EAAZ,CAAjB,EAA2DL,IAAII,IAAJ,CAASI,QAApE,EAA8E,UAASC,GAAT,EAAcC,OAAd,EAAsB;AAC/F,UAAID,GAAJ,EAAS;AACNR,YAAIU,IAAJ,CAASF,GAAT;AACF;;AAEL,yBAASG,YAAT,CACE,OADF,EACW;AACPC,iBAAS;AADF,OADX,EAGKb,GAHL,EAGUC,GAHV,EAGe,YAAM;AAChBA,YAAIa,IAAJ,CAAS,EAACC,SAAS,mCAAV,EAAT;AACF,OALH;AAMA,KAXD;AAYD,GAdD;;AAkBA;AACAjB,MAAIC,IAAJ,CAAS,QAAT,EAAmB,mBAASa,YAAT,CACjB,OADiB,EACR;AACPC,aAAS,KADF;AAEPG,WAAO;AAFA,GADQ,CAAnB;;AAQF;;AAEElB,MAAImB,GAAJ,CAAQ,SAAR,gCAAgC,UAACjB,GAAD,EAAKC,GAAL,EAAY;AACxCA,QAAIiB,MAAJ;AACAjB,QAAIkB,MAAJ,CAAW,GAAX,EAAgBR,IAAhB,CAAqB,0BAArB;AACH,GAHD;;AAMAb,MAAImB,GAAJ,CAAQ,KAAR,gCAA4B,UAACjB,GAAD,EAAKC,GAAL,EAAY;AACpCA,QAAIkB,MAAJ,CAAW,GAAX,EAAgBR,IAAhB,CAAqBX,IAAIoB,IAAzB;AACH,GAFD;;AAKC,SAAOtB,GAAP;AAEF,C","file":"account.js","sourcesContent":["import mongoose  from \"mongoose\";\nimport { Router } from \"express\";\nimport Account from \"../model/account\"\nimport bodyPaser from \"body-parser\";\nimport passport  from \"passport\";\nimport  config   from '../config';\n\nimport {generateAccessToken, respond, authenticate}  from '../middleware/authMiddleware';\n\n\n\n export default ({config, db}) => {\n      let api = Router();\n\n  api.post('/register', (req,res)=>{\n       console.log(req.body.email)\n    Account.register(new Account({ username: req.body.email}), req.body.password, function(err, account){\n         if (err) {\n            res.send(err)\n         }\n\n     passport.authenticate(\n       'local', {\n         session: false\n       })(req, res, () => {\n          res.json({message: 'successfully  created new account'});\n       });\n    });\n  });\n\n\n\n  //v1 account login\n  api.post('/login', passport.authenticate (\n    'local', {\n      session: false,\n      scope: []\n    }), generateAccessToken, respond);\n\n\n\n//v1 account logout\n\n  api.get('/logout',authenticate, (req,res)=> {\n      res.logout();\n      res.status(200).send('successfully  logged out');\n  });\n\n\n  api.get('/me',authenticate, (req,res)=> {\n      res.status(200).send(req.user);\n  });\n\n\n   return api;\n\n}\n"]}