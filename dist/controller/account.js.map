{"version":3,"sources":["../../src/controller/account.js"],"names":["config","db","api","post","req","res","register","username","body","email","password","err","account","send","authenticate","session","status","scope","get","logout","user"],"mappings":";;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;kBAIgB,gBAAkB;AAAA,MAAhBA,MAAgB,QAAhBA,MAAgB;AAAA,MAARC,EAAQ,QAARA,EAAQ;;AAC5B,MAAIC,MAAM,sBAAV;;AAEJA,MAAIC,IAAJ,CAAS,WAAT,EAAsB,UAACC,GAAD,EAAKC,GAAL,EAAW;AAC/B,sBAAQC,QAAR,CAAiB,sBAAY,EAAEC,UAAUH,IAAII,IAAJ,CAASC,KAArB,EAAZ,CAAjB,EAA2DL,IAAII,IAAJ,CAASE,QAApE,EAA8E,UAASC,GAAT,EAAcC,OAAd,EAAsB;AAC/F,UAAID,GAAJ,EAAS;AACNN,YAAIQ,IAAJ,CAASF,GAAT;AACF;AACL,yBAASG,YAAT,CACE,OADF,EACW;AACPC,iBAAS;AADF,OADX,EAGKX,GAHL,EAGUC,GAHV,EAGe,YAAM;AAChBA,YAAIW,MAAJ,CAAW,GAAX,EAAgBH,IAAhB,CAAqB,mCAArB;AACF,OALH;AAMA,KAVD;AAWD,GAZD;;AAgBA;AACAX,MAAIC,IAAJ,CAAS,QAAT,EAAmB,mBAASW,YAAT,CACjB,OADiB,EACR;AACPC,aAAS,KADF;AAEPE,WAAO;AAFA,GADQ,CAAnB;;AAQF;;AAEEf,MAAIgB,GAAJ,CAAQ,SAAR,gCAAgC,UAACd,GAAD,EAAKC,GAAL,EAAY;AACxCA,QAAIc,MAAJ;AACAd,QAAIW,MAAJ,CAAW,GAAX,EAAgBH,IAAhB,CAAqB,0BAArB;AACH,GAHD;;AAMAX,MAAIgB,GAAJ,CAAQ,KAAR,gCAA4B,UAACd,GAAD,EAAKC,GAAL,EAAY;AACpCA,QAAIW,MAAJ,CAAW,GAAX,EAAgBH,IAAhB,CAAqBT,IAAIgB,IAAzB;AACH,GAFD;;AAKC,SAAOlB,GAAP;AAEF,C","file":"account.js","sourcesContent":["import mongoose  from \"mongoose\";\nimport { Router } from \"express\";\nimport Account from \"../model/account\"\nimport bodyPaser from \"body-parser\";\nimport passport  from \"passport\";\nimport  config   from '../config';\n\nimport {generateAccessToken, respond, authenticate}  from '../middleware/authMiddleware';\n\n\n\n export default ({config, db}) => {\n      let api = Router();\n\n  api.post('/register', (req,res)=>{\n    Account.register(new Account({ username: req.body.email}), req.body.password, function(err, account){\n         if (err) {\n            res.send(err)\n         }\n     passport.authenticate(\n       'local', {\n         session: false\n       })(req, res, () => {\n          res.status(200).send('successfully  created new account');\n       });\n    });\n  });\n\n\n\n  //v1 account login\n  api.post('/login', passport.authenticate (\n    'local', {\n      session: false,\n      scope: []\n    }), generateAccessToken, respond);\n\n\n\n//v1 account logout\n\n  api.get('/logout',authenticate, (req,res)=> {\n      res.logout();\n      res.status(200).send('successfully  logged out');\n  });\n\n\n  api.get('/me',authenticate, (req,res)=> {\n      res.status(200).send(req.user);\n  });\n\n\n   return api;\n\n}\n"]}